<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Assistant</title>
    <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/styles/github-dark.min.css">
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    zIndex: {
                        '100': '100',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white dark:bg-slate-900">

<header class="sticky top-0 z-50 bg-slate-900 border-b border-slate-300/10 backdrop-blur [@supports(backdrop-filter:blur(0))]:bg-slate-900/75">
    <nav class="mx-auto flex max-w-5xl items-center justify-between p-6" aria-label="Global">
        <div class="flex items-center">
            <a href="#">
                <span class="sr-only">Assistant</span>
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-9 h-9 fill-indigo-500">
                        <path fill-rule="evenodd" d="M9 4.5a.75.75 0 0 1 .721.544l.813 2.846a3.75 3.75 0 0 0 2.576 2.576l2.846.813a.75.75 0 0 1 0 1.442l-2.846.813a3.75 3.75 0 0 0-2.576 2.576l-.813 2.846a.75.75 0 0 1-1.442 0l-.813-2.846a3.75 3.75 0 0 0-2.576-2.576l-2.846-.813a.75.75 0 0 1 0-1.442l2.846-.813A3.75 3.75 0 0 0 7.466 7.89l.813-2.846A.75.75 0 0 1 9 4.5ZM18 1.5a.75.75 0 0 1 .728.568l.258 1.036c.236.94.97 1.674 1.91 1.91l1.036.258a.75.75 0 0 1 0 1.456l-1.036.258c-.94.236-1.674.97-1.91 1.91l-.258 1.036a.75.75 0 0 1-1.456 0l-.258-1.036a2.625 2.625 0 0 0-1.91-1.91l-1.036-.258a.75.75 0 0 1 0-1.456l1.036-.258a2.625 2.625 0 0 0 1.91-1.91l.258-1.036A.75.75 0 0 1 18 1.5ZM16.5 15a.75.75 0 0 1 .712.513l.394 1.183c.15.447.5.799.948.948l1.183.395a.75.75 0 0 1 0 1.422l-1.183.395c-.447.15-.799.5-.948.948l-.395 1.183a.75.75 0 0 1-1.422 0l-.395-1.183a1.5 1.5 0 0 0-.948-.948l-1.183-.395a.75.75 0 0 1 0-1.422l1.183-.395c.447-.15.799-.5.948-.948l.395-1.183A.75.75 0 0 1 16.5 15Z" clip-rule="evenodd" />
                    </svg>
                </div>
            </a>
            <div class="lg:flex ml-3">
                <a href="#" class="text-lg font-semibold leading-6 text-white">OpenAPI Assistant</a>
            </div>
        </div>
        <div class="lg:flex">
            <a class="group" aria-label="GitHub" href="https://github.com/open-solid/open-api-assistant-bundle" target="_blank">
                <svg aria-hidden="true" viewBox="0 0 16 16" class="h-6 w-6 fill-slate-400 group-hover:fill-slate-500 dark:group-hover:fill-slate-300"><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"></path></svg>
            </a>
        </div>
    </nav>
</header>

<form action="{{ path('openapi_assistant') }}" method="post" name="form">
    <div class="container mx-auto max-w-5xl px-5">
        <h2 class="text-base font-semibold leading-7 text-white mt-6">New Endpoint</h2>
        <p class="mb-1 text-sm leading-6 text-gray-400">Create API endpoints and specs from payloads.</p>

        <div class="space-y-4">
            <div class="space-y-4 sm:space-x-4 sm:flex">
                <div class="mt-4 sm:flex-none">
                    <label for="{{ form.method.vars.id }}" class="block text-sm font-medium leading-6 text-white">Method</label>
                    <div class="mt-2">
                        {{ form_widget(form.method, {'attr': {'class': 'block rounded-md border-0 bg-slate-800 py-1.5 text-white shadow-sm ring-1 ring-inset ' ~ (form.method.vars.errors|length > 0 ? 'ring-2 ring-rose-500 focus:ring-rose-500' : 'ring-white/10') ~ ' focus:ring-2 focus:ring-inset focus:ring-indigo-500 sm:text-sm sm:leading-6 [&_*]:text-black'}}) }}
                        {% for error in form.method.vars.errors %}
                            <p class="mt-2 text-sm text-rose-500">{{ error.message }}</p>
                        {% endfor %}
                    </div>
                </div>

                <div class="sm:flex-1 sm:grow">
                    <label for="{{ form.uri.vars.id }}" class="block text-sm font-medium leading-6 text-white">URI</label>
                    <div class="mt-2">
                        <div class="flex rounded-md bg-slate-800 ring-1 ring-inset {{ form.uri.vars.errors|length > 0 ? 'ring-2 ring-rose-500 focus-within:ring-rose-500' : 'ring-white/10' }} focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-500">
                            <label for="{{ form.uri.vars.id }}"
                                   class="flex select-none items-center pl-3 text-gray-500 sm:text-sm">https://localhost/</label>
                            <input type="text"
                                   autofocus="autofocus"
                                   name="{{ field_name(form.uri) }}"
                                   autocomplete="off"
                                   required
                                   id="{{ form.uri.vars.id }}"
                                   class="flex-1 border-0 bg-transparent py-1.5 pl-0 text-white focus:ring-0 sm:text-sm sm:leading-6"
                                   placeholder="products"
                                   value="{{ field_value(form.uri) }}"
                            >
                        </div>
                        {% for error in form.uri.vars.errors %}
                            <p class="mt-2 text-sm text-rose-500">{{ error.message }}</p>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="space-y-4 md:space-y-0 md:space-x-4 md:flex">
                <div class="md:flex-1">
                    <div class="flex items-center">
                        <label for="{{ form.req.vars.id }}" class="block text-sm font-medium leading-6 text-white">Request</label>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"
                             class="w-5 h-5 fill-white ml-1 hidden">
                            <path fill-rule="evenodd"
                                  d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z"
                                  clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="mt-2">
                        <textarea rows="10"
                                  name="{{ field_name(form.req) }}"
                                  id="{{ form.req.vars.id }}"
                                  class="block w-full rounded-md border-0 bg-slate-800 py-1.5 text-white shadow-sm ring-1 ring-inset focus:ring-2 focus:ring-inset focus:ring-indigo-500 {{ form.req.vars.errors|length > 0 ? 'ring-2 ring-rose-500 focus:ring-rose-500' : 'ring-white/10' }} sm:text-sm sm:leading-6"
                                  placeholder="Add your request payload..."
                        >{{ field_value(form.req) }}</textarea>
                        {% for error in form.req.vars.errors %}
                            <p class="mt-2 text-sm text-rose-500">{{ error.message }}</p>
                        {% endfor %}
                    </div>
                </div>

                <div class="md:flex-1">
                    <div class="flex items-center">
                        <label for="{{ form.res.vars.id }}" class="block text-sm font-medium leading-6 text-white">Response</label>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"
                             class="w-5 h-5 fill-white ml-1 hidden">
                            <path fill-rule="evenodd"
                                  d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z"
                                  clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="mt-2">
                        <textarea rows="10"
                                  name="{{ field_name(form.res) }}"
                                  id="{{ form.res.vars.id }}"
                                  class="block w-full rounded-md border-0 bg-slate-800 py-1.5 text-white shadow-sm ring-1 ring-inset focus:ring-2 focus:ring-inset focus:ring-indigo-500 {{ form.res.vars.errors|length > 0 ? 'ring-2 ring-rose-500 focus:ring-rose-500' : 'ring-white/10' }} sm:text-sm sm:leading-6"
                                  placeholder="Add your response payload..."
                        >{{ field_value(form.res) }}</textarea>
                        {% for error in form.res.vars.errors %}
                            <p class="mt-2 text-sm text-rose-500">{{ error.message }}</p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-4 flex items-center justify-between gap-x-6">
            <button type="submit"
                    name="action"
                    value="preview"
                    class="inline-flex items-center gap-x-1.5 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="-ml-0.5 h-5 w-5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                </svg>
                Preview
            </button>
            <button type="reset" class="rounded-md bg-white/10 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-white/20">Reset</button>
        </div>
    </div>

    <div class="container mx-auto max-w-5xl px-5">
        <hr class="border-slate-800 my-6">
    </div>

    <div class="container mx-auto max-w-5xl px-5 space-y-4 pb-10">
        {% if preview.openapi_spec is defined %}
            <div>
                <div class="text-slate-300 px-3 py-2 inline-block bg-slate-800 rounded-t-md">OpenAPI.yaml</div>
                <pre class="text-sm"><code class="rounded-tl-none rounded-md bg-slate-800 language-yaml">{{ preview.openapi_spec }}</code></pre>
            </div>
        {% endif %}

        {% if preview.controller_code is defined %}
            <div>
                <div class="text-slate-300 px-3 py-2 inline-block bg-slate-800 rounded-t-md">{{ preview.controller_class_name }}.php</div>
                <pre class="text-sm"><code class="rounded-tl-none rounded-md bg-slate-800 language-php">{{ preview.controller_code }}</code></pre>
            </div>
        {% endif %}

        {% if preview.payload_classes_code is defined %}
            {% for name, payload_code in preview.payload_classes_code %}
                <div>
                    <div class="text-slate-300 px-3 py-2 inline-block bg-slate-800 rounded-t-md">{{ name }}.php</div>
                    <pre class="text-sm"><code class="rounded-tl-none rounded-md bg-slate-800 language-php">{{ payload_code }}</code></pre>
                </div>
            {% endfor %}
        {% endif %}

        {% if preview.openapi_spec is defined %}
            <button type="submit"
                    name="action"
                    value="generate"
                    class="inline-flex items-center gap-x-1.5 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="-ml-0.5 h-5 w-5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z" />
                </svg>
                Generate
            </button>
        {% endif %}
    </div>
</form>

<div aria-live="assertive" class="pointer-events-none fixed z-100 inset-0 flex items-end px-4 py-6 sm:items-start sm:p-6">
    <div class="flex w-full flex-col items-center space-y-4 sm:items-end">
        {% for type, messages in app.flashes %}
            {% for message in messages %}
                <div class="pointer-events-auto w-full max-w-sm overflow-hidden rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5 dark:bg-slate-800 dark:ring-white dark:ring-opacity-25 transform ease-out duration-300 transition translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-2">
                    <div class="p-4">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                {% if type == 'success' %}
                                    <svg class="h-6 w-6 text-green-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                {% else %}
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-rose-500">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
                                    </svg>
                                {% endif %}
                            </div>
                            <div class="ml-3 w-0 flex-1 pt-0.5">
                                <p class="text-sm font-medium text-white">{{ message.title }}</p>
                                <p class="mt-1 text-sm text-gray-500">{{ message.body }}</p>
                            </div>
                            <div class="ml-4 flex flex-shrink-0">
                                <button id="close-flash-button" type="button" class="inline-flex rounded-md bg-slate-800 text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-0">
                                    <span class="sr-only">Close</span>
                                    <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                        <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% endfor %}
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        hljs.highlightAll()

        const closeFlashButton = document.querySelector('#close-flash-button');
        if (closeFlashButton) {
            <!--
              Entering: "transform ease-out duration-300 transition"
                From: "translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-2"
                To: "translate-y-0 opacity-100 sm:translate-x-0"
              Leaving: "transition ease-in duration-100"
                From: "opacity-100"
                To: "opacity-0"
            -->
            const flashBox = closeFlashButton.closest('.pointer-events-auto');

            // Entering
            flashBox.classList.remove('translate-y-2', 'opacity-0', 'sm:translate-x-2');
            flashBox.classList.add('translate-y-0', 'opacity-100', 'sm:translate-x-0');

            flashBox.addEventListener('transitionend', function () {
                if (this.classList.contains('opacity-0')) {
                    this.remove()
                }
            })

            closeFlashButton.addEventListener('click', function () {
                // Leaving
                flashBox.classList.remove('transform', 'translate-y-0', 'ease-out', 'opacity-100', 'duration-300', 'sm:translate-y-0', 'sm:translate-x-0');
                flashBox.classList.add('ease-in', 'duration-100', 'opacity-0');
            })
        }
    })
</script>
</body>
</html>
