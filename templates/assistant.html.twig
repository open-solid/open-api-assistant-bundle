<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Assistant</title>
    <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/styles/github-dark.min.css">
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    zIndex: {
                        '100': '100',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white dark:bg-slate-900">

<header class="sticky top-0 z-50 bg-slate-900 border-b border-slate-300/10 backdrop-blur [@supports(backdrop-filter:blur(0))]:bg-slate-900/75">
    <nav class="mx-auto flex max-w-5xl items-center justify-between p-6" aria-label="Global">
        <div class="flex items-center">
            <a href="#">
                <span class="sr-only">Assistant</span>
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-9 h-9 fill-indigo-500">
                        <path fill-rule="evenodd" d="M9 4.5a.75.75 0 0 1 .721.544l.813 2.846a3.75 3.75 0 0 0 2.576 2.576l2.846.813a.75.75 0 0 1 0 1.442l-2.846.813a3.75 3.75 0 0 0-2.576 2.576l-.813 2.846a.75.75 0 0 1-1.442 0l-.813-2.846a3.75 3.75 0 0 0-2.576-2.576l-2.846-.813a.75.75 0 0 1 0-1.442l2.846-.813A3.75 3.75 0 0 0 7.466 7.89l.813-2.846A.75.75 0 0 1 9 4.5ZM18 1.5a.75.75 0 0 1 .728.568l.258 1.036c.236.94.97 1.674 1.91 1.91l1.036.258a.75.75 0 0 1 0 1.456l-1.036.258c-.94.236-1.674.97-1.91 1.91l-.258 1.036a.75.75 0 0 1-1.456 0l-.258-1.036a2.625 2.625 0 0 0-1.91-1.91l-1.036-.258a.75.75 0 0 1 0-1.456l1.036-.258a2.625 2.625 0 0 0 1.91-1.91l.258-1.036A.75.75 0 0 1 18 1.5ZM16.5 15a.75.75 0 0 1 .712.513l.394 1.183c.15.447.5.799.948.948l1.183.395a.75.75 0 0 1 0 1.422l-1.183.395c-.447.15-.799.5-.948.948l-.395 1.183a.75.75 0 0 1-1.422 0l-.395-1.183a1.5 1.5 0 0 0-.948-.948l-1.183-.395a.75.75 0 0 1 0-1.422l1.183-.395c.447-.15.799-.5.948-.948l.395-1.183A.75.75 0 0 1 16.5 15Z" clip-rule="evenodd" />
                    </svg>
                </div>
            </a>
            <div class="lg:flex ml-3">
                <a href="#" class="text-lg font-semibold leading-6 text-white">OpenAPI Assistant</a>
            </div>
        </div>
        <div class="lg:flex">
            <a class="group" aria-label="GitHub" href="https://github.com/open-solid/open-api-assistant-bundle" target="_blank">
                <svg aria-hidden="true" viewBox="0 0 16 16" class="h-6 w-6 fill-slate-400 group-hover:fill-slate-500 dark:group-hover:fill-slate-300"><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"></path></svg>
            </a>
        </div>
    </nav>
</header>

<form action="{{ path('openapi_assistant') }}" method="post" name="form">
    <div class="container mx-auto max-w-5xl px-5">
        <h2 class="text-base font-semibold leading-7 text-white mt-6">New Endpoint</h2>
        <p class="mb-1 text-sm leading-6 text-slate-400">Create API endpoints and specs from payloads.</p>

        {% set form_errors = form.vars.errors|length %}
        {% if form_errors > 0 %}
            <div class="rounded-md bg-rose-950 p-4 mt-4">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-rose-400">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-sm font-medium text-rose-400">There {{ form_errors > 1 ? 'were' : 'is' }} {{ form_errors }} error{{ form_errors > 1 ? 's' }} with your submission</h3>
                        <div class="mt-2 text-sm text-rose-400">
                            <ul role="list" class="list-disc space-y-1 pl-5">
                                {% for error in form.vars.errors %}
                                    <li>{{ error.message }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}

        <div class="space-y-4">
            <div class="space-y-4 sm:space-x-4 sm:flex">
                <div class="mt-4 sm:flex-none">
                    <label for="{{ form.method.vars.id }}" class="block text-sm font-medium leading-6 text-white">Method</label>
                    <div class="mt-2">
                        {{ form_widget(form.method, {'attr': {'class': 'block rounded-md border-0 bg-slate-800 py-1.5 text-white shadow-sm ring-1 ring-inset ' ~ (form.method.vars.errors|length > 0 ? 'ring-2 ring-rose-500 focus:ring-rose-500' : 'ring-white/10') ~ ' focus:ring-2 focus:ring-inset focus:ring-indigo-500 sm:text-sm sm:leading-6 [&_*]:text-black'}}) }}
                        {% for error in form.method.vars.errors %}
                            <p class="mt-2 text-sm text-rose-500">{{ error.message }}</p>
                        {% endfor %}
                    </div>
                </div>

                <div class="sm:flex-1 sm:grow">
                    <label for="{{ form.uri.vars.id }}" class="block text-sm font-medium leading-6 text-white">URI</label>
                    <div class="mt-2">
                        <div class="flex rounded-md bg-slate-800 ring-1 ring-inset {{ form.uri.vars.errors|length > 0 ? 'ring-2 ring-rose-500 focus-within:ring-rose-500' : 'ring-white/10' }} focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-500">
                            <label for="{{ form.uri.vars.id }}"
                                   class="flex select-none items-center pl-3 text-slate-500 sm:text-sm">https://localhost/</label>
                            <input type="text"
                                   autofocus="autofocus"
                                   name="{{ field_name(form.uri) }}"
                                   autocomplete="off"
                                   required
                                   id="{{ form.uri.vars.id }}"
                                   class="flex-1 border-0 bg-transparent py-1.5 pl-0 text-white focus:ring-0 sm:text-sm sm:leading-6"
                                   placeholder="products"
                                   value="{{ field_value(form.uri) }}"
                            >
                        </div>
                        {% for error in form.uri.vars.errors %}
                            <p class="mt-2 text-sm text-rose-500">{{ error.message }}</p>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="space-y-4 md:space-y-0 md:space-x-4 md:flex">
                <div class="md:flex-1">
                    <div class="flex items-center">
                        <label for="{{ form.req.vars.id }}" class="block text-sm font-medium leading-6 text-white">Request</label>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"
                             class="w-5 h-5 fill-white ml-1 hidden">
                            <path fill-rule="evenodd"
                                  d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z"
                                  clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="mt-2">
                        <textarea rows="10"
                                  name="{{ field_name(form.req) }}"
                                  id="{{ form.req.vars.id }}"
                                  class="block w-full rounded-md border-0 bg-slate-800 py-1.5 text-white shadow-sm ring-1 ring-inset focus:ring-2 focus:ring-inset focus:ring-indigo-500 {{ form.req.vars.errors|length > 0 ? 'ring-2 ring-rose-500 focus:ring-rose-500' : 'ring-white/10' }} sm:text-sm sm:leading-6"
                                  placeholder="Add your request payload..."
                        >{{ field_value(form.req) }}</textarea>
                        {% for error in form.req.vars.errors %}
                            <p class="mt-2 text-sm text-rose-500">{{ error.message }}</p>
                        {% endfor %}
                    </div>
                </div>

                <div class="md:flex-1">
                    <div class="flex items-center">
                        <label for="{{ form.res.vars.id }}" class="block text-sm font-medium leading-6 text-white">Response</label>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"
                             class="w-5 h-5 fill-white ml-1 hidden">
                            <path fill-rule="evenodd"
                                  d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z"
                                  clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="mt-2">
                        <textarea rows="10"
                                  name="{{ field_name(form.res) }}"
                                  id="{{ form.res.vars.id }}"
                                  class="block w-full rounded-md border-0 bg-slate-800 py-1.5 text-white shadow-sm ring-1 ring-inset focus:ring-2 focus:ring-inset focus:ring-indigo-500 {{ form.res.vars.errors|length > 0 ? 'ring-2 ring-rose-500 focus:ring-rose-500' : 'ring-white/10' }} sm:text-sm sm:leading-6"
                                  placeholder="Add your response payload..."
                        >{{ field_value(form.res) }}</textarea>
                        {% for error in form.res.vars.errors %}
                            <p class="mt-2 text-sm text-rose-500">{{ error.message }}</p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-4 flex items-center justify-between gap-x-6">
            <button type="submit"
                    name="action"
                    value="preview"
                    class="inline-flex items-center gap-x-1.5 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="-ml-0.5 h-5 w-5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z" />
                </svg>
                Preview
            </button>
            <button type="reset" class="rounded-md bg-white/10 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-white/20">Reset</button>
        </div>
    </div>

    <div class="container mx-auto max-w-5xl px-5">
        <hr class="border-slate-800 my-6">
    </div>

    <div class="container mx-auto max-w-5xl px-5 space-y-4 pb-10">
        {% if preview.openapi_spec is defined %}
            <div>
                <h2 class="text-base font-semibold leading-7 text-white mt-6">OpenAPI Specification Preview</h2>
                <p class="mb-1 text-sm leading-6 text-slate-400">Generated from your endpoint data.</p>
            </div>

            <div>
                <nav class="flex border-b border-slate-800" aria-label="Tabs">
                    <ul role="tablist" class="flex min-w-full flex-none gap-x-1 text-sm leading-6 text-slate-400">
                        <li>
                            <a id="tab-0"
                               role="tab"
                               class="cursor-pointer aria-selected:text-white hover:text-slate-300 border-b-2 border-transparent aria-selected:border-indigo-500 py-3 px-3 inline-block"
                               aria-selected="true"
                               aria-controls="tabpanel-0"
                            >openapi.yaml</a>
                        </li>
                    </ul>
                </nav>
                <div id="tabpanel-0"
                     role="tabpanel"
                     tabindex="0"
                     aria-labelledby="tab-0"
                     class="flex items-start bg-slate-800/60"
                >
                    <div aria-hidden="true" class="select-none border-r border-slate-300/5 px-4 font-mono text-slate-600 text-sm leading-6 pt-3.5">
                        {% for ln in 1..(preview.openapi_spec.yaml|split('\n')|length) %}
                            {{ ln|length < 2 ? '0' ~ ln : ln }}<br>
                        {% endfor %}
                    </div>
                    <pre><code class="rounded-tl-none rounded-md bg-transparent language-yaml">{{ preview.openapi_spec.yaml }}</code></pre>
                </div>
            </div>
        {% endif %}

        {% if preview.classes_code is defined %}
            <div class="container mx-auto max-w-5xl">
                <hr class="border-slate-800 my-6">
            </div>

            <div>
                <h2 class="text-base font-semibold leading-7 text-white mt-6">PHP Code Preview</h2>
                <p class="mb-1 text-sm leading-6 text-slate-400">Generated from your OpenAPI specification.</p>
            </div>

            <div class="tabs">
                <div class="mx-auto max-w-7xl">
                    <div class="sm:hidden">
                        <label for="tabs" class="sr-only">Select a tab</label>
                        <!-- TODO: Use an "onChange" listener to redirect the user to the selected tab URL. -->
                        <select id="tabs" class="block w-full rounded-md border-none bg-slate/5 py-2 pl-3 pr-10 text-base text-white shadow-sm ring-1 ring-inset ring-slate/10 focus:ring-2 focus:ring-inset focus:ring-indigo-500 sm:text-sm">
                            {% for name, class_code in preview.classes_code %}
                                <option {{ loop.first ? 'selected' }}>{{ name }}.php</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="hidden sm:block">
                        <nav class="flex border-b border-slate-800" aria-label="Tabs">
                            <ul role="tablist" class="flex min-w-full flex-none gap-x-1 text-sm leading-6 text-slate-400">
                                {% for name, class_code in preview.classes_code %}
                                    <li>
                                        <a id="tab-class-{{ loop.index }}"
                                           role="tab"
                                           class="cursor-pointer aria-selected:text-white hover:text-slate-300 border-b-2 border-transparent aria-selected:border-indigo-500 py-3 px-3 inline-block"
                                           aria-selected="{{ loop.first ? 'true' : 'false' }}"
                                           aria-controls="tabpanel-class-{{ loop.index }}"
                                           {% if not loop.first %}tabindex="-1"{% endif %}
                                        >{{ name }}.php</a>
                                    </li>
                                {% endfor %}
                            </ul>
                        </nav>
                    </div>
                </div>
                <div class="tabs-content">
                    {% for name, class_code in preview.classes_code %}
                        <div id="tabpanel-class-{{ loop.index }}"
                             role="tabpanel"
                             tabindex="0"
                             aria-labelledby="tab-class-{{ loop.index }}"
                             class="flex items-start {{ not loop.first ? 'hidden' }} bg-slate-800/60"
                        >
                            {% set code_lines = class_code|split('\n')|length + 1 %}
                            <div aria-hidden="true" class="select-none border-r border-slate-300/5 px-4 font-mono text-slate-600 text-sm leading-6 pt-3.5">
                                {% for ln in 1..preview.line_numbers %}
                                    {% if ln <= code_lines %}
                                        {{ ln|length < 2 ? '0' ~ ln : ln }}
                                    {% else %}
                                        {{ ' ' }}
                                    {% endif %}
                                    <br>
                                {% endfor %}
                            </div>
                            <pre><code class="rounded-tl-none rounded-md bg-transparent language-php">{{ class_code }}</code></pre>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}

        {% if preview.openapi_spec is defined %}
            <button type="submit"
                    name="action"
                    value="save"
                    class="inline-flex items-center gap-x-1.5 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="-ml-0.5 h-5 w-5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                </svg>
                Save All
            </button>
        {% endif %}
    </div>
</form>

<div aria-live="assertive" class="pointer-events-none fixed z-100 inset-0 flex items-end px-4 py-6 sm:items-start sm:p-6">
    <div class="flex w-full flex-col items-center space-y-4 sm:items-end">
        {% for type, messages in app.flashes %}
            {% for message in messages %}
                <div class="pointer-events-auto w-full max-w-sm overflow-hidden rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5 dark:bg-slate-800 dark:ring-white dark:ring-opacity-25 transform ease-out duration-300 transition translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-2">
                    <div class="p-4">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                {% if type == 'success' %}
                                    <svg class="h-6 w-6 text-green-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                {% else %}
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-rose-500">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
                                    </svg>
                                {% endif %}
                            </div>
                            <div class="ml-3 w-0 flex-1 pt-0.5">
                                <p class="text-sm font-medium text-white">{{ message.title }}</p>
                                <p class="mt-1 text-sm text-gray-500">{{ message.body }}</p>
                            </div>
                            <div class="ml-4 flex flex-shrink-0">
                                <button id="close-flash-button" type="button" class="inline-flex rounded-md bg-slate-800 text-slate-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-0">
                                    <span class="sr-only">Close</span>
                                    <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                        <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% endfor %}
    </div>
</div>

<script>
    'use strict'

    class TabsAutomatic {
        constructor(groupNode) {
            this.tablistNode = groupNode

            this.tabs = []

            this.firstTab = null
            this.lastTab = null

            this.tabs = Array.from(this.tablistNode.querySelectorAll('[role=tab]'))
            this.tabpanels = []

            for (let i = 0; i < this.tabs.length; i += 1) {
                const tab = this.tabs[i]
                const tabpanel = document.getElementById(tab.getAttribute('aria-controls'))

                tab.tabIndex = -1
                tab.setAttribute('aria-selected', 'false')
                this.tabpanels.push(tabpanel)

                tab.addEventListener('keydown', this.onKeydown.bind(this))
                tab.addEventListener('click', this.onClick.bind(this))

                if (!this.firstTab) {
                    this.firstTab = tab
                }
                this.lastTab = tab
            }

            this.setSelectedTab(this.firstTab, false)
        }

        setSelectedTab(currentTab, setFocus) {
            if (typeof setFocus !== 'boolean') {
                setFocus = true
            }
            for (let i = 0; i < this.tabs.length; i += 1) {
                const tab = this.tabs[i]
                if (currentTab === tab) {
                    tab.setAttribute('aria-selected', 'true')
                    tab.removeAttribute('tabindex')
                    this.tabpanels[i].classList.remove('hidden')
                    if (setFocus) {
                        tab.focus()
                    }
                } else {
                    tab.setAttribute('aria-selected', 'false')
                    tab.tabIndex = -1
                    this.tabpanels[i].classList.add('hidden')
                }
            }
        }

        setSelectedToPreviousTab(currentTab) {
            if (currentTab === this.firstTab) {
                this.setSelectedTab(this.lastTab)
            } else {
                const index = this.tabs.indexOf(currentTab)
                this.setSelectedTab(this.tabs[index - 1])
            }
        }

        setSelectedToNextTab(currentTab) {
            if (currentTab === this.lastTab) {
                this.setSelectedTab(this.firstTab)
            } else {
                const index = this.tabs.indexOf(currentTab)
                this.setSelectedTab(this.tabs[index + 1])
            }
        }

        /* EVENT HANDLERS */

        onKeydown(event) {
            const tgt = event.currentTarget
            let flag = false

            switch (event.key) {
                case 'ArrowLeft':
                    this.setSelectedToPreviousTab(tgt)
                    flag = true
                    break

                case 'ArrowRight':
                    this.setSelectedToNextTab(tgt)
                    flag = true
                    break

                case 'Home':
                    this.setSelectedTab(this.firstTab)
                    flag = true
                    break

                case 'End':
                    this.setSelectedTab(this.lastTab)
                    flag = true
                    break

                default:
                    break
            }

            if (flag) {
                event.stopPropagation()
                event.preventDefault()
            }
        }

        onClick(event) {
            this.setSelectedTab(event.currentTarget)
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        hljs.highlightAll()

        const tablists = document.querySelectorAll('[role=tablist]')
        for (let i = 0; i < tablists.length; i++) {
            new TabsAutomatic(tablists[i])
        }

        const closeFlashButton = document.querySelector('#close-flash-button')
        if (closeFlashButton) {
            const flashBox = closeFlashButton.closest('.pointer-events-auto')

            // Entering
            flashBox.classList.remove('translate-y-2', 'opacity-0', 'sm:translate-x-2')
            flashBox.classList.add('translate-y-0', 'opacity-100', 'sm:translate-x-0')

            flashBox.addEventListener('transitionend', function () {
                if (this.classList.contains('opacity-0')) {
                    this.remove()
                }
            })

            closeFlashButton.addEventListener('click', function () {
                // Leaving
                flashBox.classList.remove('transform', 'translate-y-0', 'ease-out', 'opacity-100', 'duration-300', 'sm:translate-y-0', 'sm:translate-x-0')
                flashBox.classList.add('ease-in', 'duration-100', 'opacity-0')
            })
        }
    })
</script>
</body>
</html>
